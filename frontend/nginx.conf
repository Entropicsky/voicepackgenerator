# Target File: frontend/nginx.conf
# Instructions: Create Nginx configuration for serving React static files and proxying API requests.

# frontend/nginx.conf (processed by envsubst in start.sh)
events {}

http {
  server {
    listen       ${PORT};
    server_name  _;

    # Serve React static files
    root  /app/frontend/dist;
    index index.html;

    location / {
      try_files $uri /index.html;
      add_header Cache-Control "no-store, no-cache, must-revalidate";
    }

    # Proxy API requests to Flask
    location /api/ {
      proxy_pass         http://127.0.0.1:5000;
      proxy_set_header   Host             $host;
      proxy_set_header   X-Real-IP        $remote_addr;
      proxy_set_header   X-Forwarded-For  $remote_addr;
      proxy_set_header   X-Forwarded-Proto $scheme;
    }

    # Proxy audio requests to Flask
    location /audio/ {
      proxy_pass http://127.0.0.1:5000;
    }
  }
} 