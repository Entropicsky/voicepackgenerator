setup:
  addons:
    - plan: heroku-redis
      as: REDIS

build:
  docker:
    # Temporarily run backend directly as web for debugging
    web: backend/Dockerfile
    # api: backend/Dockerfile # Disabled for debugging
    worker: backend/Dockerfile

run:
  # Temporarily run backend directly as web
  web: gunicorn backend.app:app --bind 0.0.0.0:$PORT --timeout 120
  # api: gunicorn backend.app:app --bind 0.0.0.0:$PORT --timeout 120 # Disabled for debugging
  worker: celery -A backend.celery_app:celery worker --loglevel=info
