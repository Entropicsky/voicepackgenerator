setup:
  addons:
    - plan: heroku-redis
      as: REDIS

build:
  docker:
    # Consolidated web dyno using Nginx + Gunicorn
    web:
      dockerfile: Dockerfile # Use Dockerfile at root
      context: . # Explicitly set build context to project root
    # api process removed
    worker: backend/Dockerfile

run:
  # Run the consolidated start script for web
  web: sh start.sh
  # api process removed
  worker: celery -A backend.celery_app:celery worker --loglevel=info
